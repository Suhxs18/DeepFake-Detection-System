<<<<<<< HEAD
# DeepFake Detection System

A comprehensive deep learning system for detecting manipulated/synthetic media (images and video frames) generated by deepfake techniques. Built with PyTorch, leveraging facenet_pytorch for face detection, and OpenCV for video/image processing.

## Project Overview

This system provides a modular and extensible codebase for deepfake detection with the following capabilities:

- **Face Detection & Extraction**: Automatically detects and extracts faces from images and video frames
- **Deep Learning Model**: CNN-based classifier for binary classification (real vs fake)
- **Video Processing**: Frame extraction and face detection from video files
- **Training Pipeline**: Complete training loop with validation and testing
- **Inference**: Real-time prediction on images and videos

## Project Structure

```
deepfake_detector/
├── data/
│   ├── raw/                    # Raw input data (videos, images)
│   └── processed_faces/        # Processed face images
│       ├── train/
│       │   ├── real/          # Training real faces
│       │   └── fake/          # Training fake faces
│       ├── val/
│       │   ├── real/          # Validation real faces
│       │   └── fake/          # Validation fake faces
│       └── test/
│           ├── real/          # Test real faces
│           └── fake/          # Test fake faces
├── models/                     # Saved trained models
├── scripts/                    # Executable scripts
│   ├── preprocess_data.py     # Data preprocessing pipeline
│   ├── train.py              # Model training script
│   └── predict.py            # Inference script
├── src/                       # Core modules
│   ├── dataset.py            # Dataset class and data loading
│   ├── model.py              # Neural network model definition
│   └── utils.py              # Utility functions
├── requirements.txt           # Python dependencies
└── README.md                 # This file
```

## Installation

1. **Clone the repository**:
   ```bash
   git clone <repository-url>
   cd deepfake_detector
   ```

2. **Create a virtual environment** (recommended):
   ```bash
   python -m venv venv
   source venv/bin/activate  # On Windows: venv\Scripts\activate
   ```

3. **Install dependencies**:
   ```bash
   pip install -r requirements.txt
   ```

## Usage

### 1. Data Preprocessing

Before training, you need to preprocess your raw data (videos/images) to extract faces:

```bash
python scripts/preprocess_data.py
```

**Configuration**: Edit the configuration variables in `scripts/preprocess_data.py`:
- Set your raw data paths
- Configure face extraction parameters
- Define train/val/test splits

### 2. Model Training

Train the deepfake detection model:

```bash
python scripts/train.py
```

**Configuration**: Edit the configuration variables in `scripts/train.py`:
- Set training hyperparameters (epochs, batch size, learning rate)
- Configure model save paths
- Define data augmentation settings

### 3. Inference

Run predictions on new images or videos:

```bash
# Predict on a single image
python scripts/predict.py --image path/to/image.jpg

# Predict on a video
python scripts/predict.py --video path/to/video.mp4

# Predict on multiple files
python scripts/predict.py --input_dir path/to/input/directory
```

## Data Format

### Input Data Structure

Place your raw data in the `data/raw/` directory:

```
data/raw/
├── real/
│   ├── video1.mp4
│   ├── video2.mp4
│   └── image1.jpg
└── fake/
    ├── fake_video1.mp4
    ├── fake_video2.mp4
    └── fake_image1.jpg
```

### Processed Data Structure

After preprocessing, faces will be automatically organized in:

```
data/processed_faces/
├── train/
│   ├── real/          # Training real faces
│   └── fake/          # Training fake faces
├── val/
│   ├── real/          # Validation real faces
│   └── fake/          # Validation fake faces
└── test/
    ├── real/          # Test real faces
    └── fake/          # Test fake faces
```

## Model Architecture

The system uses a CNN-based classifier with the following features:

- **Backbone**: ResNet18 (pre-trained on ImageNet)
- **Classification Head**: Custom fully connected layers for binary classification
- **Input Size**: 224x224 RGB face images
- **Output**: Binary classification (real vs fake)

## Performance Metrics

The system evaluates performance using:

- **Accuracy**: Overall classification accuracy
- **Precision**: True positives / (True positives + False positives)
- **Recall**: True positives / (True positives + False negatives)
- **F1-Score**: Harmonic mean of precision and recall
- **ROC AUC**: Area under the Receiver Operating Characteristic curve
- **Confusion Matrix**: Detailed breakdown of predictions

## Customization

### Adding New Models

To add a new model architecture:

1. Create a new class in `src/model.py`
2. Inherit from `nn.Module`
3. Implement the `forward()` method
4. Update the model instantiation in `scripts/train.py`

### Custom Data Augmentation

Modify the transform pipeline in `src/dataset.py` to add custom augmentations using Albumentations.

### Hyperparameter Tuning

Edit the configuration variables in `scripts/train.py` to experiment with different hyperparameters.

## Troubleshooting

### Common Issues

1. **CUDA Out of Memory**: Reduce batch size in training configuration
2. **Face Detection Fails**: Ensure images contain clear, front-facing faces
3. **Poor Performance**: Check data quality and balance between real/fake samples

### GPU Requirements

- **Minimum**: 4GB GPU memory
- **Recommended**: 8GB+ GPU memory for faster training
- **CPU**: Training possible but significantly slower

## Contributing

1. Fork the repository
2. Create a feature branch
3. Make your changes
4. Add tests if applicable
5. Submit a pull request

## License

This project is licensed under the MIT License - see the LICENSE file for details.

## Acknowledgments

- [facenet-pytorch](https://github.com/timesler/facenet-pytorch) for face detection
- [PyTorch](https://pytorch.org/) for deep learning framework
- [OpenCV](https://opencv.org/) for computer vision operations 
=======
# Projects
>>>>>>> eb6872a84c0d8d2e6d42ff06dfd50a7952b46d36
